{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/assessment/assessment-pt-imp/nextjs/src/app/posts/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { motion } from \"framer-motion\";\r\nimport toast from \"react-hot-toast\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport default function PostsPage() {\r\n  const [posts, setPosts] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [page, setPage] = useState(1);\r\n  const [lastPage, setLastPage] = useState(1);\r\n  const router = useRouter();\r\n\r\n  const fetchPosts = async (pageNumber = 1) => {\r\n    setLoading(true);\r\n    try {\r\n      const storedToken = localStorage.getItem(\"token\");\r\n      setToken(storedToken);\r\n      const res = await fetch(`/api/proxy/posts?page=${pageNumber}`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          Authorization: `Bearer ${storedToken}`,\r\n        },\r\n      });\r\n\r\n      if (!res.ok) throw new Error(\"Gagal memuat postingan\");\r\n\r\n      const data = await res.json();\r\n      // Struktur Laravel pagination\r\n      setPosts(Array.isArray(data.data) ? data.data : []);\r\n      setPage(data.current_page || 1);\r\n      setLastPage(data.last_page || 1);\r\n    } catch (err: any) {\r\n      toast.error(err.message);\r\n      setPosts([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id: number) => {\r\n    if (!confirm(\"Yakin ingin menghapus postingan ini?\")) return;\r\n\r\n    try {\r\n      const res = await fetch(`/api/proxy/posts/${id}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n\r\n      if (!res.ok) throw new Error(\"Gagal menghapus post\");\r\n\r\n      toast.success(\"Post berhasil dihapus!\");\r\n      fetchPosts(page); // refresh data di halaman saat ini\r\n    } catch (err: any) {\r\n      toast.error(\"Terjadi kesalahan saat menghapus post\");\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    if (confirm(\"Yakin ingin logout?\")) {\r\n      localStorage.removeItem(\"token\");\r\n      toast.success(\"Berhasil logout ðŸ‘‹\");\r\n      router.push(\"/\");\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchPosts(page);\r\n  }, [page]);\r\n\r\n  if (loading)\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center h-screen\">\r\n        <span className=\"loading loading-spinner text-primary w-10 h-10\"></span>\r\n        <p className=\"mt-4 text-gray-500\">Memuat data...</p>\r\n      </div>\r\n    );\r\n\r\n  if (posts.length === 0)\r\n    return (\r\n      <div className=\"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-100 dark:from-gray-900 dark:via-gray-950 dark:to-black transition-all\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 15 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"text-center bg-white/60 dark:bg-gray-900/60 backdrop-blur-md border border-white/20 shadow-xl rounded-3xl p-10\"\r\n        >\r\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-3\">\r\n            ðŸ“„ Belum Ada Postingan\r\n          </h1>\r\n          <p className=\"text-gray-500 dark:text-gray-400\">\r\n            Mulailah membuat postingan pertama Anda.\r\n          </p>\r\n          <Link href=\"/posts/create\" className=\"btn btn-primary mt-5 px-8\">\r\n            + Buat Postingan\r\n          </Link>\r\n        </motion.div>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-100 dark:from-gray-900 dark:via-gray-950 dark:to-black transition-all p-8\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex flex-col sm:flex-row justify-between items-center mb-8 space-y-3 sm:space-y-0\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <h1 className=\"text-3xl font-bold text-gray-800 dark:text-white\">\r\n              âœ¨ Daftar Postingan\r\n            </h1>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            <Link href=\"/posts/create\" className=\"btn btn-primary\">\r\n              + Buat Baru\r\n            </Link>\r\n\r\n            {token && (\r\n              <button\r\n                onClick={handleLogout}\r\n                className=\"btn btn-outline btn-error\"\r\n              >\r\n                Logout\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Grid of cards */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8\">\r\n          {posts.map((post, i) => (\r\n            <motion.div\r\n              key={post.id}\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: i * 0.05 }}\r\n              className=\"card bg-white/80 dark:bg-gray-900/60 backdrop-blur-sm border border-white/20 shadow-lg hover:shadow-2xl transition-all duration-300\"\r\n            >\r\n              <div className=\"card-body p-5\">\r\n                <h2 className=\"card-title text-lg text-gray-800 dark:text-gray-100\">\r\n                  {post.title}\r\n                </h2>\r\n                <p className=\"text-gray-600 dark:text-gray-400 mt-1\">\r\n                  {post.body?.length > 100\r\n                    ? post.body.slice(0, 100) + \"...\"\r\n                    : post.body}\r\n                </p>\r\n                <div className=\"card-actions justify-end mt-4\">\r\n                  <Link\r\n                    href={`/posts/${post.id}`}\r\n                    className=\"btn btn-sm btn-outline\"\r\n                  >\r\n                    View\r\n                  </Link>\r\n                  <Link\r\n                    href={`/posts/${post.id}/edit`}\r\n                    className=\"px-2 btn btn-sm btn-secondary\"\r\n                  >\r\n                    Edit\r\n                  </Link>\r\n                  {token && (\r\n                    <button\r\n                      onClick={() => handleDelete(post.id)}\r\n                      className=\"px-2 btn btn-sm btn-error\"\r\n                    >\r\n                      Delete\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Pagination */}\r\n        <div className=\"flex justify-center items-center gap-2 mt-8\">\r\n          <button\r\n            className=\"btn btn-sm\"\r\n            disabled={page === 1}\r\n            onClick={() => setPage(page - 1)}\r\n          >\r\n            Â« Prev\r\n          </button>\r\n          <span className=\"text-gray-600 dark:text-gray-300\">\r\n            Halaman {page} dari {lastPage}\r\n          </span>\r\n          <button\r\n            className=\"btn btn-sm\"\r\n            disabled={page === lastPage}\r\n            onClick={() => setPage(page + 1)}\r\n          >\r\n            Next Â»\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}